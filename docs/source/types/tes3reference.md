# tes3reference
<div class="search_terms" style="display: none">tes3reference, reference</div>

<!---
	This file is autogenerated. Do not edit this file manually. Your changes will be ignored.
	More information: https://github.com/MWSE/MWSE/tree/master/docs
-->

A reference is a sort of container structure for objects. It holds a base object, as well as various variables associated with that object that make it unique.

For example, many doors may share the same base object. However, each door reference might have a different owner, different lock/trap statuses, etc. that make the object unique.

This type inherits the following: [tes3object](../types/tes3object.md), [tes3baseObject](../types/tes3baseObject.md)
## Properties

### `activationReference`
<div class="search_terms" style="display: none">activationreference</div>

The current reference, if any, that this reference will activate.

**Returns**:

* `result` ([tes3reference](../types/tes3reference.md))

***

### `attachments`
<div class="search_terms" style="display: none">attachments</div>

*Read-only*. A table with friendly named access to all supported attachments.

**Returns**:

* `result` (table&lt;string, [tes3bodyPartManager](../types/tes3bodyPartManager.md)|[tes3itemData](../types/tes3itemData.md)|[tes3lightNode](../types/tes3lightNode.md)|[tes3lockNode](../types/tes3lockNode.md)|[tes3mobileActor](../types/tes3mobileActor.md)|[tes3reference](../types/tes3reference.md)|[tes3travelDestinationNode](../types/tes3travelDestinationNode.md)|[tes3animationData](../types/tes3animationData.md)&gt;)

***

### `baseObject`
<div class="search_terms" style="display: none">baseobject</div>

*Read-only*. This is similar to the object field, but is guaranteed to provide the base-most object. If object is an actor clone, the base actor will be given instead.

**Returns**:

* `result` ([tes3physicalObject](../types/tes3physicalObject.md))

***

### `blocked`
<div class="search_terms" style="display: none">blocked</div>

The blocked state of the object.

**Returns**:

* `result` (boolean)

***

### `bodyPartManager`
<div class="search_terms" style="display: none">bodypartmanager</div>

*Read-only*. Access to the reference's body part manager, if available. Typically this is only available on NPC references.

**Returns**:

* `result` ([tes3bodyPartManager](../types/tes3bodyPartManager.md), nil)

***

### `cell`
<div class="search_terms" style="display: none">cell</div>

*Read-only*. The cell that the reference is currently in.

**Returns**:

* `result` ([tes3cell](../types/tes3cell.md))

***

### `context`
<div class="search_terms" style="display: none">context</div>

*Read-only*. Access to the script context for this reference and its associated script.

**Returns**:

* `result` ([tes3scriptContext](../types/tes3scriptContext.md))

??? example "Example: Checking reference's script variables"

	Companions usually have a mwscript script with variable named `companion` set to 1. This can be used to determine if a reference is player's companion or not. Note that companion share functionality was added to Morrowind in Tribunal expansion. In vanilla game it is used by Tribunal companions. Also, companion mods usually use this feature. But note that all the followers (during certain parts of their quests) from base Morrowind don't have companion share.

	```lua
	--- This function returns `true` if the reference
	--- has a variable companion set to 1 in its script.
	---@param reference tes3reference
	---@return boolean
	local function hasCompanionShare(reference)
	
		-- Any local script variable inside `tes3scriptContext`
		-- objects can be read as if it were a normal Lua table
		-- (`reference.context` is of `tes3scriptContext` type)
		local companion = reference.context.companion
		-- or:
		-- local companion = reference.context["companion"]
	
		-- In addition, local script variables can be accessed from the tes3npc object:
		-- myNpc.script.context.somVarName
	
		-- To change the variable value, do an assignment:
		-- reference.context.companion = 0
	
		return (
			companion and
			companion == 1 or
			false
		)
	end

	```

??? example "Example: Checking if an actor is a follower"

	In this example we provide a way to check if a certain actor is currently player's follower. This function can also be useful besides the one from previous example, since not all of the followers have companion share enabled.

	```lua
	--- This function returns `true` if a given mobile has
	--- follow ai package with player as its target
	---@param mobile tes3mobileNPC|tes3mobileCreature
	---@return boolean isFollower
	local function isFollower(mobile)
		local planner = mobile.aiPlanner
		if not planner then
			return false
		end
	
		local package = planner:getActivePackage()
		if not package then
			return false
		end
		if package.type == tes3.aiPackage.follow
		-- Depending on your needs, you can also include the actor's escorter.
		-- In the base game, AiEscort package is quite rare. Only White Guar
		-- has that package and targetActor is the player.
		or package.type == tes3.aiPackage.escort then
			local target = package.targetActor
	
			if target.objectType == tes3.objectType.mobilePlayer then
				return true
			end
		end
		return false
	end
	
	--- With the above function we can build a function that
	--- creates a table with all of the player's followers
	---@return tes3reference[] followerList
	local function getFollowers()
		local followers = {}
		local i = 1
	
		for _, mobile in pairs(tes3.mobilePlayer.friendlyActors) do
			---@cast mobile tes3mobileNPC|tes3mobileCreature
			if isFollower(mobile) then
				followers[i] = mobile.reference
				i = i + 1
			end
		end
	
		return followers
	end

	```

***

### `data`
<div class="search_terms" style="display: none">data</div>

A generic lua table that data can be written to, and synced to/from the save. All information stored must be valid for serialization to json. For item references, this is the same table as on the `tes3itemData` structure. To store data that doesn't get serialized to/from the save, use `tempData`.

There is a guide available [here](https://mwse.github.io/MWSE/guides/storing-data/) on using this table.

**Returns**:

* `result` (table)

***

### `deleted`
<div class="search_terms" style="display: none">deleted</div>

*Read-only*. The deleted state of the object.

**Returns**:

* `result` (boolean)

***

### `destination`
<div class="search_terms" style="display: none">destination</div>

*Read-only*. Returns the travel destination node for this reference, or `nil`. This can be used to determine where a given door links to.

**Returns**:

* `result` ([tes3travelDestinationNode](../types/tes3travelDestinationNode.md), nil)

***

### `disabled`
<div class="search_terms" style="display: none">disabled</div>

*Read-only*. The disabled state of the object.

**Returns**:

* `result` (boolean)

***

### `facing`
<div class="search_terms" style="display: none">facing</div>

Convenient access to the z-component of the reference's orientation in range of [-PI, PI] for actors and [0, 2PI] radians for all the other references. The North is facing of 0. Setting the facing sets the reference as modified.

**Returns**:

* `result` (number)

***

### `forwardDirection`
<div class="search_terms" style="display: none">forwarddirection</div>

*Read-only*. The normalized forward or Y direction vector of the reference.

**Returns**:

* `result` ([tes3vector3](../types/tes3vector3.md))

***

### `hasNoCollision`
<div class="search_terms" style="display: none">hasnocollision, nocollision</div>

Sets the no-collision flag on this reference, and recalculates collision groups. Use the [`setNoCollisionFlag()`](https://mwse.github.io/MWSE/types/tes3reference/?h=setnocollisionflag#setnocollisionflag) function to manage collision group recalculation instead.

**Returns**:

* `result` (boolean)

***

### `id`
<div class="search_terms" style="display: none">id</div>

*Read-only*. The unique identifier for the object.

**Returns**:

* `result` (string)

***

### `isDead`
<div class="search_terms" style="display: none">isdead, dead</div>

*Read-only*. Returns `true` if the object is dead, `false` if they are alive, or `nil` if that couldn't be determined.

**Returns**:

* `result` (boolean, nil)

***

### `isEmpty`
<div class="search_terms" style="display: none">isempty, empty</div>

Friendly access onto the reference's empty inventory flag.

**Returns**:

* `result` (boolean)

***

### `isLeveledSpawn`
<div class="search_terms" style="display: none">isleveledspawn, leveledspawn</div>

*Read-only*. If true, this reference was created as a result of a leveled spawn.

**Returns**:

* `result` (boolean)

***

### `isLocationMarker`
<div class="search_terms" style="display: none">islocationmarker, locationmarker</div>

True if this object is an editor marker for a gameplay location. These include travel, intervention, prison, door, and interior north markers. Markers are invisible in-game.

**Returns**:

* `result` (boolean)

***

### `isRespawn`
<div class="search_terms" style="display: none">isrespawn, respawn</div>

*Read-only*. If true, the references respawn flag is set.

**Returns**:

* `result` (boolean)

***

### `itemData`
<div class="search_terms" style="display: none">itemdata</div>

Gets or sets the attached `itemData` for this reference. If set to `nil`, the item data will be unhooked but not deleted.

**Returns**:

* `result` ([tes3itemData](../types/tes3itemData.md))

***

### `leveledBaseReference`
<div class="search_terms" style="display: none">leveledbasereference</div>

*Read-only*. If this reference is a leveled spawn, this is the leveled creature spawn reference. If this reference wasn't the result of a leveled spawn, the value is `nil`.

**Returns**:

* `result` ([tes3reference](../types/tes3reference.md), nil)

***

### `light`
<div class="search_terms" style="display: none">light</div>

*Read-only*. Direct access to the scene graph light, if a dynamic light is set.

**Returns**:

* `result` ([niPointLight](../types/niPointLight.md))

***

### `lockNode`
<div class="search_terms" style="display: none">locknode</div>

*Read-only*. Quick access to the reference's lock node, if any. Doors or containers that aren't locked nor trapped have this property set to `nil`.

**Returns**:

* `result` ([tes3lockNode](../types/tes3lockNode.md), nil)

***

### `mesh`
<div class="search_terms" style="display: none">mesh</div>

The path to the object's mesh.

**Returns**:

* `result` (string)

***

### `mobile`
<div class="search_terms" style="display: none">mobile</div>

*Read-only*. Access to the attached mobile object, if applicable.

**Returns**:

* `result` ([tes3mobileCreature](../types/tes3mobileCreature.md), [tes3mobileNPC](../types/tes3mobileNPC.md), [tes3mobilePlayer](../types/tes3mobilePlayer.md), [tes3mobileProjectile](../types/tes3mobileProjectile.md), [tes3mobileSpellProjectile](../types/tes3mobileSpellProjectile.md), nil)

***

### `modified`
<div class="search_terms" style="display: none">modified, ified</div>

The modification state of the object since the last save.

**Returns**:

* `result` (boolean)

***

### `nextInCollection`
<div class="search_terms" style="display: none">nextincollection</div>

The next object in parent collection's list.

**Returns**:

* `result` ([tes3object](../types/tes3object.md))

***

### `nextNode`
<div class="search_terms" style="display: none">nextnode</div>

*Read-only*. The next reference in the parent reference list.

**Returns**:

* `result` ([tes3reference](../types/tes3reference.md))

***

### `nodeData`
<div class="search_terms" style="display: none">nodedata</div>

*Read-only*. Redundant access to this object, for iterating over a tes3referenceList.

**Returns**:

* `result` ([tes3reference](../types/tes3reference.md))

***

### `object`
<div class="search_terms" style="display: none">object</div>

*Read-only*. The object that the reference is for, such as a weapon, armor, or actor.

**Returns**:

* `result` ([tes3physicalObject](../types/tes3physicalObject.md))

***

### `objectFlags`
<div class="search_terms" style="display: none">objectflags</div>

*Read-only*. The raw flags of the object.

**Returns**:

* `result` (number)

***

### `objectType`
<div class="search_terms" style="display: none">objecttype</div>

*Read-only*. The type of object. Maps to values in [`tes3.objectType`](https://mwse.github.io/MWSE/references/object-types/).

**Returns**:

* `result` ([tes3.objectType](../references/object-types.md))

***

### `orientation`
<div class="search_terms" style="display: none">orientation</div>

Access to the reference's orientation, in XYZ Euler angles in radians in [0, 2 PI] except for actors. For actors, the Z angle is in range [-PI, PI] radians. Changing the orientation marks the reference as modified.

**Returns**:

* `result` ([tes3vector3](../types/tes3vector3.md))

***

### `owningCollection`
<div class="search_terms" style="display: none">owningcollection</div>

The collection responsible for holding this object.

**Returns**:

* `result` ([tes3referenceList](../types/tes3referenceList.md))

***

### `persistent`
<div class="search_terms" style="display: none">persistent</div>

The persistent flag of the object.

**Returns**:

* `result` (boolean)

***

### `position`
<div class="search_terms" style="display: none">position</div>

Access to the reference's position. Setting the position sets the reference as modified.

For actors, the axes are:

 - X right - left(+)
 - Y front - back(+)
 - Z down  - up(+)


**Returns**:

* `result` ([tes3vector3](../types/tes3vector3.md))

***

### `previousInCollection`
<div class="search_terms" style="display: none">previousincollection</div>

The previous object in parent collection's list.

**Returns**:

* `result` ([tes3object](../types/tes3object.md))

***

### `previousNode`
<div class="search_terms" style="display: none">previousnode</div>

*Read-only*. The previous reference in the parent reference list.

**Returns**:

* `result` ([tes3reference](../types/tes3reference.md))

***

### `rightDirection`
<div class="search_terms" style="display: none">rightdirection</div>

*Read-only*. The normalized right or X direction vector of the reference.

**Returns**:

* `result` ([tes3vector3](../types/tes3vector3.md))

***

### `scale`
<div class="search_terms" style="display: none">scale</div>

The object's scale. The value range is (0, 10).

**Returns**:

* `result` (number)

***

### `sceneCollisionRoot`
<div class="search_terms" style="display: none">scenecollisionroot</div>

The scene graph node for this object's physics collision, if its mesh has a root collision node.

**Returns**:

* `result` ([niNode](../types/niNode.md))

***

### `sceneNode`
<div class="search_terms" style="display: none">scenenode</div>

*Read-only*. The scene graph node that the reference uses for rendering.

**Returns**:

* `result` ([niNode](../types/niNode.md), nil)

***

### `sourceFormId`
<div class="search_terms" style="display: none">sourceformid</div>

No description yet available.

**Returns**:

* `result` (number)

***

### `sourceless`
<div class="search_terms" style="display: none">sourceless</div>

The soruceless flag of the object.

**Returns**:

* `result` (boolean)

***

### `sourceMod`
<div class="search_terms" style="display: none">sourcemod</div>

*Read-only*. The filename (including the extension) of the mod that owns this object. It has `nil` value if the object was anything other than loaded from an ESP or ESM file.

**Returns**:

* `result` (string)

***

### `sourceModId`
<div class="search_terms" style="display: none">sourcemodid</div>

No description yet available.

**Returns**:

* `result` (number)

***

### `stackSize`
<div class="search_terms" style="display: none">stacksize</div>

Access to the size of a stack, if the reference represents one or more items.

**Returns**:

* `result` (number)

***

### `startingOrientation`
<div class="search_terms" style="display: none">startingorientation</div>

*Read-only*. Access to the reference's original orientation. Note that this value is invalid for NPCs and creatures.

**Returns**:

* `result` ([tes3vector3](../types/tes3vector3.md))

***

### `startingPosition`
<div class="search_terms" style="display: none">startingposition</div>

*Read-only*. Access to the reference's original position. Note that this value is invalid for NPCs and creatures.

**Returns**:

* `result` ([tes3vector3](../types/tes3vector3.md))

***

### `supportsLuaData`
<div class="search_terms" style="display: none">supportsluadata</div>

If true, this reference can store temporary or persistent lua data.

**Returns**:

* `result` (boolean)

***

### `targetFormId`
<div class="search_terms" style="display: none">targetformid</div>

No description yet available.

**Returns**:

* `result` (number)

***

### `targetModId`
<div class="search_terms" style="display: none">targetmodid</div>

No description yet available.

**Returns**:

* `result` (number)

***

### `tempData`
<div class="search_terms" style="display: none">tempdata</div>

As with the `data` field, a generic lua table that data can be written to. No information in this table will persist into saves. For item references, this is the same table as on the `tes3itemData` structure.

There is a guide available [here](https://mwse.github.io/MWSE/guides/storing-data/) on using this table.

**Returns**:

* `result` (table)

***

### `upDirection`
<div class="search_terms" style="display: none">updirection</div>

*Read-only*. The normalized up or Z direction vector of the reference.

**Returns**:

* `result` ([tes3vector3](../types/tes3vector3.md))

***

## Methods

### `__tojson`
<div class="search_terms" style="display: none">__tojson</div>

Serializes the object to json.

```lua
local string = myObject:__tojson()
```

**Returns**:

* `string` (string)

***

### `activate`
<div class="search_terms" style="display: none">activate</div>

Causes this reference to activate another. This will lead them to go through doors, pick up items, etc.

```lua
myObject:activate(reference)
```

**Parameters**:

* `reference` ([tes3reference](../types/tes3reference.md)): The other reference to activate.

***

### `clearActionFlag`
<div class="search_terms" style="display: none">clearactionflag</div>

Unsets a bit in the reference's action data attachment

```lua
myObject:clearActionFlag(flagIndex)
```

**Parameters**:

* `flagIndex` ([tes3.actionFlag](../references/action-flags.md)): The action flag to clear. Maps to values in [`tes3.actionFlag`](https://mwse.github.io/MWSE/references/action-flags/) namespace.

***

### `clone`
<div class="search_terms" style="display: none">clone</div>

Clones a reference for a base actor into a reference to an instance of that actor. For example, this will force a container to resolve its leveled items and have its own unique inventory. Also, marks the new cloned reference as modified.

```lua
local cloned = myObject:clone()
```

**Returns**:

* `cloned` (boolean): Returns `true` if the reference was successfully cloned. Returns `false` if the reference was already cloned or can't be cloned.

***

### `delete`
<div class="search_terms" style="display: none">delete</div>

Disables the reference, removes all its attachments, resets its scale, and sets the reference to be deleted.

```lua
myObject:delete()
```

***

### `deleteDynamicLightAttachment`
<div class="search_terms" style="display: none">deletedynamiclightattachment, dynamiclightattachment</div>

Deletes the dynamic light attachment, if it exists. This will automatically detach the dynamic light from affected nodes.

```lua
myObject:deleteDynamicLightAttachment(removeLightFromParent)
```

**Parameters**:

* `removeLightFromParent` (boolean): *Default*: `false`. If `true`, the dynamic light is removed from its parent node as well.

***

### `detachDynamicLightFromAffectedNodes`
<div class="search_terms" style="display: none">detachdynamiclightfromaffectednodes</div>

Removes the dynamic light from any affected scene graph nodes, but will not delete the associated attachment.

```lua
myObject:detachDynamicLightFromAffectedNodes()
```

***

### `disable`
<div class="search_terms" style="display: none">disable</div>

Hides the reference, detaches all dynamic lights and sounds, and stops any mobile simulation. Sets the reference as modified implicitly.

```lua
local success = myObject:disable()
```

**Returns**:

* `success` (boolean): If `true`, the reference was successfully disabled.

***

### `enable`
<div class="search_terms" style="display: none">enable</div>

Shows the reference, reattaches all dynamic lights and sounds, and restarts any mobile simulation if the player is close enough. Sets the reference as modified implicitly.

```lua
local success = myObject:enable()
```

**Returns**:

* `success` (boolean): If `true`, the reference was successfully enabled.

***

### `getAngleTo`
<div class="search_terms" style="display: none">getangleto, angleto</div>

Calculates the angle from this reference's current facing to the target reference.

```lua
local angle = myObject:getAngleTo(reference)
```

**Parameters**:

* `reference` ([tes3reference](../types/tes3reference.md)): The reference to calculate the angle to.

**Returns**:

* `angle` (number): The angle to the given reference in radians.

***

### `getAttachedDynamicLight`
<div class="search_terms" style="display: none">getattacheddynamiclight, attacheddynamiclight</div>

Fetches the dynamic light attachment.

```lua
local result = myObject:getAttachedDynamicLight()
```

**Returns**:

* `result` ([tes3lightNode](../types/tes3lightNode.md))

***

### `getOrCreateAttachedDynamicLight`
<div class="search_terms" style="display: none">getorcreateattacheddynamiclight, orcreateattacheddynamiclight</div>

Fetches the dynamic light attachment. If there isn't one, a new one will be created with the given light and value.

If no light is supplied as an argument, a point light of radius 512 will be automatically created.

If the light is not attached to any part of the scene graph yet, the point light will be placed as a child of the "attachLight" subnode of the model, or a child of the model if "attachLight" is not found.

```lua
local result = myObject:getOrCreateAttachedDynamicLight(light, phase)
```

**Parameters**:

* `light` ([niPointLight](../types/niPointLight.md)): *Optional*.
* `phase` (number): *Optional*.

**Returns**:

* `result` ([tes3lightNode](../types/tes3lightNode.md))

***

### `onCloseInventory`
<div class="search_terms" style="display: none">oncloseinventory</div>

A function that tells the game that an inventory has been closed, if you are simulating inventory operations. It has the capability of un-cloning an inventory if it has not been modified. Typically not used outside of specific purposes.

```lua
local result = myObject:onCloseInventory()
```

**Returns**:

* `result` (boolean)

***

### `setActionFlag`
<div class="search_terms" style="display: none">setactionflag, actionflag</div>

Sets a bit in the reference's action data attachment.

```lua
myObject:setActionFlag(flagIndex)
```

**Parameters**:

* `flagIndex` ([tes3.actionFlag](../references/action-flags.md)): The action flag to clear. Maps to values in [`tes3.actionFlag`](https://mwse.github.io/MWSE/references/action-flags/) namespace.

***

### `setDynamicLighting`
<div class="search_terms" style="display: none">setdynamiclighting, dynamiclighting</div>

Sets the dynamic lighting state of the reference using the global data handler.

```lua
myObject:setDynamicLighting()
```

***

### `setNoCollisionFlag`
<div class="search_terms" style="display: none">setnocollisionflag, nocollisionflag</div>

Sets if this reference has active collision. This is preferable to changing the `hasNoCollision` property, if you are manipulating multiple objects at once and do not want to constantly recalculate collision groups.

```lua
myObject:setNoCollisionFlag(hasNoCollision, updateCollisions)
```

**Parameters**:

* `hasNoCollision` (boolean): If `true`, the reference no longer has collision.
* `updateCollisions` (boolean): *Default*: `true`. If `true`, collision groups for the active cells are recalculated.

***

### `testActionFlag`
<div class="search_terms" style="display: none">testactionflag, actionflag</div>

Returns the flag's value in the reference's action data attachment.

```lua
local result = myObject:testActionFlag(flagIndex)
```

**Parameters**:

* `flagIndex` ([tes3.actionFlag](../references/action-flags.md)): The action flag to test. Maps to values in [`tes3.actionFlag`](https://mwse.github.io/MWSE/references/action-flags/) namespace.

**Returns**:

* `result` (boolean)

***

### `updateEquipment`
<div class="search_terms" style="display: none">updateequipment, equipment</div>

Causes the reference, if of an actor, to update the reference's bodyparts with the currently equipped ones.

```lua
myObject:updateEquipment()
```

***

### `updateLighting`
<div class="search_terms" style="display: none">updatelighting, lighting</div>

Updates the lighting of the reference using the global data handler.

```lua
myObject:updateLighting()
```

***

### `updateSceneGraph`
<div class="search_terms" style="display: none">updatescenegraph, scenegraph</div>

Updates the reference's local rotation matrix, propagates position changes to the scene graph, and sets the reference's modified flag. You need to call this if the orientation or position was manually modified.

```lua
myObject:updateSceneGraph()
```

