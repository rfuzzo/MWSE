# tes3magicSourceInstance
<div class="search_terms" style="display: none">tes3magicsourceinstance, magicsourceinstance</div>

<!---
	This file is autogenerated. Do not edit this file manually. Your changes will be ignored.
	More information: https://github.com/MWSE/MWSE/tree/master/docs
-->

A game structure that keeps track of a magic source and all the actors it affects. Each spell cast, alchemy or enchanted item use is a magic source. Area effect magic can hit multiple actors and have up to 8 effects. Individual magic effects are `tes3magicEffectInstance`s.

This type inherits the following: [tes3baseObject](../types/tes3baseObject.md)
## Properties

### `blocked`
<div class="search_terms" style="display: none">blocked</div>

The blocked state of the object.

**Returns**:

* `result` (boolean)

***

### `castChanceOverride`
<div class="search_terms" style="display: none">castchanceoverride</div>

No description yet available.

**Returns**:

* `result` (number)

***

### `caster`
<div class="search_terms" style="display: none">caster</div>

*Read-only*. No description yet available.

**Returns**:

* `result` ([tes3reference](../types/tes3reference.md))

***

### `corprusHoursSinceLastWorsen`
<div class="search_terms" style="display: none">corprushourssincelastworsen</div>

The number of hours passed since the player's corprus state last worsened.

**Returns**:

* `result` (number)

***

### `deleted`
<div class="search_terms" style="display: none">deleted</div>

*Read-only*. The deleted state of the object.

**Returns**:

* `result` (boolean)

***

### `disabled`
<div class="search_terms" style="display: none">disabled</div>

*Read-only*. The disabled state of the object.

**Returns**:

* `result` (boolean)

***

### `id`
<div class="search_terms" style="display: none">id</div>

*Read-only*. The unique identifier for the object.

**Returns**:

* `result` (string)

***

### `item`
<div class="search_terms" style="display: none">item</div>

*Read-only*. No description yet available.

**Returns**:

* `result` ([tes3item](../types/tes3item.md))

***

### `itemData`
<div class="search_terms" style="display: none">itemdata</div>

*Read-only*. No description yet available.

**Returns**:

* `result` ([tes3itemData](../types/tes3itemData.md))

***

### `itemID`
<div class="search_terms" style="display: none">itemid</div>

*Read-only*. No description yet available.

**Returns**:

* `result` (string)

***

### `magicID`
<div class="search_terms" style="display: none">magicid</div>

*Read-only*. For spells created in the Contruction Set, this is the id of the spell defined there. For spells created during play, with spellmaking, this is a number.

**Returns**:

* `result` (string)

***

### `modified`
<div class="search_terms" style="display: none">modified, ified</div>

The modification state of the object since the last save.

**Returns**:

* `result` (boolean)

***

### `objectFlags`
<div class="search_terms" style="display: none">objectflags</div>

*Read-only*. The raw flags of the object.

**Returns**:

* `result` (number)

***

### `objectType`
<div class="search_terms" style="display: none">objecttype</div>

*Read-only*. The type of object. Maps to values in [`tes3.objectType`](https://mwse.github.io/MWSE/references/object-types/).

**Returns**:

* `result` ([tes3.objectType](../references/object-types.md))

***

### `persistent`
<div class="search_terms" style="display: none">persistent</div>

The persistent flag of the object.

**Returns**:

* `result` (boolean)

***

### `projectile`
<div class="search_terms" style="display: none">projectile</div>

*Read-only*. No description yet available.

**Returns**:

* `result` ([tes3mobileProjectile](../types/tes3mobileProjectile.md))

***

### `serialNumber`
<div class="search_terms" style="display: none">serialnumber</div>

*Read-only*. Unique indentifier for just this magic source.

**Returns**:

* `result` (number)

***

### `source`
<div class="search_terms" style="display: none">source</div>

*Read-only*. No description yet available.

**Returns**:

* `result` ([tes3alchemy](../types/tes3alchemy.md), [tes3enchantment](../types/tes3enchantment.md), [tes3spell](../types/tes3spell.md))

***

### `sourceEffects`
<div class="search_terms" style="display: none">sourceeffects</div>

*Read-only*. An array-style table holding spell effects this magic source has.

**Returns**:

* `result` ([tes3effect](../types/tes3effect.md)[])

***

### `sourceless`
<div class="search_terms" style="display: none">sourceless</div>

The soruceless flag of the object.

**Returns**:

* `result` (boolean)

***

### `sourceMod`
<div class="search_terms" style="display: none">sourcemod</div>

*Read-only*. The filename (including the extension) of the mod that owns this object. It has `nil` value if the object was anything other than loaded from an ESP or ESM file.

**Returns**:

* `result` (string)

***

### `sourceType`
<div class="search_terms" style="display: none">sourcetype</div>

*Read-only*. The type of this magic source. Maps to [`tes3.magicSourceType`](https://mwse.github.io/MWSE/references/magic-source-types/) constants.

**Returns**:

* `result` ([tes3.magicSourceType](../references/magic-source-types.md))

***

### `state`
<div class="search_terms" style="display: none">state</div>

Shows if the state is pre-cast, cast, beginning, working, ending, retired, etc. Maps to [`tes3.spellState`](https://mwse.github.io/MWSE/references/spell-states/) constants.

**Returns**:

* `result` ([tes3.spellState](../references/spell-states.md))

***

### `supportsLuaData`
<div class="search_terms" style="display: none">supportsluadata</div>

If true, references of this object can store temporary or persistent lua data.

**Returns**:

* `result` (boolean)

***

### `target`
<div class="search_terms" style="display: none">target</div>

*Read-only*. No description yet available.

**Returns**:

* `result` ([tes3reference](../types/tes3reference.md))

***

### `timestampCastBegin`
<div class="search_terms" style="display: none">timestampcastbegin</div>

The timestamp at which this magic source was cast.

**Returns**:

* `result` (number)

***

## Methods

### `__tojson`
<div class="search_terms" style="display: none">__tojson</div>

Serializes the object to json.

```lua
local string = myObject:__tojson()
```

**Returns**:

* `string` (string)

***

### `getEffectInstance`
<div class="search_terms" style="display: none">geteffectinstance, effectinstance</div>

Gets the magic effect instance for a given effect index and target reference. Effect instances may not all be active on a target, due to reflect, absorption, dispels, different durations and other factors.

```lua
local result = myObject:getEffectInstance(index, target)
```

**Parameters**:

* `index` (number): The index in the effect list to fetch, between `0` and `7`.
* `target` ([tes3reference](../types/tes3reference.md)): The target actor for the effect.

**Returns**:

* `result` ([tes3magicEffectInstance](../types/tes3magicEffectInstance.md))

***

### `getMagnitudeForIndex`
<div class="search_terms" style="display: none">getmagnitudeforindex, magnitudeforindex</div>

Gets the magnitude from the casting source for a given effect index.

```lua
local result = myObject:getMagnitudeForIndex(index)
```

**Parameters**:

* `index` (number): The index in the effect list to fetch, between `0` and `7`.

**Returns**:

* `result` (number)

***

### `playVisualEffect`
<div class="search_terms" style="display: none">playvisualeffect</div>

This function plays an animation for an effect from the `tes3magicSourceInstance` object.

```lua
myObject:playVisualEffect({ effectIndex = ..., position = ..., visual = ..., scale = ..., reference = ... })
```

**Parameters**:

* `params` (table)
	* `effectIndex` (number): The index in the effect whose visual will be played, a number in range [0, 7].
	* `position` ([tes3vector3](../types/tes3vector3.md), number[]): A table or a `tes3vector3` holding `x`, `y` and `z` coordinates at which the visual effect will be played.
	* `visual` ([tes3physicalObject](../types/tes3physicalObject.md), string): The visual effect to be played.
	* `scale` (number): *Default*: `1`. The scale of the effect. Only applies to effects that are designed to be scaled.
	* `reference` ([tes3reference](../types/tes3reference.md), string): A reference on which the visual effect will be played.

??? example "Example: Plays the soul trap effect if the player kills a target that is affected by vampirism."

	```lua
	local function onDamaged(e)
		-- Check if we killed our target with this damage.
		if e.killingBlow then
			-- Iterate through the killed target's active magic effects.
			for _, activeMagicEffect in pairs(e.mobile.activeMagicEffectList) do
				-- Check if the target is a vampire.
				if activeMagicEffect.effectId == tes3.effect.vampirism then
					-- Play the soul trap visual effect at the position of the target.
					activeMagicEffect.instance:playVisualEffect{
						effectIndex = 0,
						position = e.mobile.position,
						visual = "VFX_Soul_Trap"
					}
					break
				end
			end
		end
	end
	
	event.register(tes3.event.damaged, onDamaged)

	```

